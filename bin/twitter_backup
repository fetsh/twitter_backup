#!/usr/bin/env ruby
# coding: utf-8

require File.expand_path(File.join(File.dirname(__FILE__), %w[.. lib twitter_backup]))

tb = TwitterBackup

if tb::TBConfig.credentials_missing?
  tb::UI.ask_credentials
end

tb::TBConfig.configure

begin

  tb::TBConfig.verify_credentials

  tb::UI.greet_user

  if tb::TBConfig.seeded?
    tb::Tweet.update_tweets
  else
    tb::Tweet.seed_tweets
  end

  tb::Tweet.dump_to_backup_file

rescue Twitter::Error::TooManyRequests => error
  tb::UI.too_many_requests_exit
ensure 
  tb::UI.exit_screen
end

