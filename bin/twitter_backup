#!/usr/bin/env ruby
# coding: utf-8

require File.expand_path(File.join(File.dirname(__FILE__), %w[.. lib twitter_backup]))

include TwitterBackup

if TBConfig.credentials_missing?
  UI.ask_credentials
end

UI.define_path_to_backup unless TBConfig.path_to_backup_defined?

begin

  TBConfig.configure
  TBConfig.verify_credentials

  UI.greet_user

  if TBConfig.seeded?
    Tweet.update_tweets
  else
    Tweet.seed_tweets
  end

  Tweet.dump_to_backup_file

rescue Twitter::Error::TooManyRequests => error
  UI.too_many_requests_exit
ensure 
  UI.exit_screen
end

